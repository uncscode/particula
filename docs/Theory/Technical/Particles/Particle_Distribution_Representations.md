# Strategies for Particle Distribution Representations

Particula uses several strategies to represent particle distributions, each with its own mathematical framework and physical interpretation. These strategies are designed to handle processes like condensation, evaporation, and particle growth while maintaining the integrity of the distribution. Below are detailed descriptions of the different strategies.

> Note: The most used strategy (and therefore most tested by users) is the **Particle Resolved Speciated Mass** strategy, which is the most flexible and accurate for representing complex aerosol dynamics. The other strategies are useful in specific contexts.

## Table of Variables

| Variable | Description |
| :--: | --- |
| $C_i$            | Number concentration of particles in bin $i$ (particles m$^{-3}$) |
| $C_k$            | Number concentration (weight) represented by particle $k$ |
| $\Delta C_i$     | Increment in number concentration for bin $i$ |
| $f(x,t)$         | Particle number distribution function with respect to $x$ |
| $G(x,t)$         | Growth rate $dx/dt$ at coordinate $x$ and time $t$ |
| $M_{\text{tot}}$ | Total aerosol mass ($\sum_i m_i C_i$) |
| $\Delta M_i$     | Total mass added to bin $i$ (all particles combined) |
| $\Delta M_b$     | Total mass added to bin $b$ |
| $\Delta \mathbf{M}_i$ | Vector of species mass added to bin $i$ |
| $m_i$            | Mass of a single particle in bin $i$ |
| $m_{i,j}$        | Mass of species $j$ in a particle of bin $i$ |
| $m_i^{\text{total}}$ | Total mass of a particle in bin $i$ ($\sum_j m_{i,j}$) |
| $\mathbf{m}_i$   | Vector of species masses in a particle of bin $i$ |
| $m_b$            | Characteristic mass defining fixed bin $b$ |
| $m_{k,j}$        | Mass of species $j$ in particle $k$ |
| $\mathbf{m}_k$   | Vector of species masses in individual particle $k$ |
| $\Delta m_i$     | Mass gained per particle in bin $i$ |
| $N_b$            | Number of particles in fixed bin $b$ |
| $\Delta N_b$     | Number of new particles created in bin $b$ (grow-in-place) |
| $N_{\text{tot}}$ | Total number concentration across all bins/particles |
| $N_p$            | Number of (model) particles tracked in the particle-resolved strategy |
| $r_i$            | Radius of a single particle in bin $i$ |
| $\rho$           | Bulk material density of the particles |
| $\rho_j$         | Density of species $j$ |
| $S$              | Number of chemical species tracked |
| $V_i$            | Volume of a single particle in bin $i$ |
| $V_{i,j}$        | Volume of species $j$ in a particle of bin $i$ |
| $x$              | Generic size coordinate (mass or radius) in continuous formulation |


## Mass-Based Moving Bin Strategy

The **Mass-Based Moving Bin** representation treats each bin as characterized by a **particle mass**. In this strategy, the distribution array stores a mass value $m_i$ for each bin (representing the mass of a single particle in that bin), and a corresponding number concentration $C_i$ (number of particles in the bin). Physically, this means all particles in bin *i* are assumed to have the same mass $m_i$, and their total mass is $m_i \times C_i$. This moving-bin approach adjusts the bin’s mass coordinate whenever mass is added, rather than shifting particles between bins.

* **Mass–Radius Relationship:** Given a particle mass $m_i$ and material density $\rho$, the particle’s **volume** is

$$
V_i = m_i/\rho
$$

The equivalent spherical **radius** is computed from volume as

$$
r_i = \left(\frac{3 V_i}{4\pi}\right)^{1/3} = \left(\frac{3 m_i}{4\pi \rho}\right)^{1/3}
$$

This follows from $m = \frac{4}{3}\pi r^3 \rho$, so each bin’s mass directly determines its particle size. (For example, if $m_i$ doubles and density stays constant, $r_i$ grows by $2^{1/3}\approx1.26\times$.)
* **Particle Mass and Total Mass:** The distribution’s mass values $m_i$ represent **per-particle mass** in each bin. The total aerosol mass in bin *i* is $m_i C_i$, and the overall mass is

$$
M_{\text{tot}} = \sum_i m_i C_i
$$

Because $m_i$ can change with processes, this strategy captures growth without needing to redistribute particles among bins.
* **Mass Addition (`add_mass`):** When mass is added to the aerosol (e.g. by vapor condensation), this strategy **increases the mass of particles in-place**. A mass increment $\Delta m_i$ added to bin *i* raises its particle mass to $m_i + \Delta m_i$. All particles in that bin grow uniformly, shifting the bin’s center to a higher mass. This *moving center* approach conserves particle number in each bin (no new bins are created or emptied during growth) and avoids numerical diffusion of the distribution. Mathematically, if $C_i$ particles each gain mass $\Delta m_i$, the bin’s total mass increases by $C_i\,\Delta m_i$ while $C_i$ stays constant.
* **Concentration Addition (`add_concentration`):** This operation adds particles (number concentration) to the distribution without altering existing particle masses. It is only valid if the incoming particles have the **same mass distribution** as the existing bin structure. In practice, the method requires that the array of new particle masses matches the current $m_i$ values (within a tolerance). If so, the concentrations are summed: $C_i \leftarrow C_i + \Delta C_i$ for each bin. This preserves each bin’s mass coordinate $m_i$ while increasing its population. If the mass profiles do not match, one cannot directly merge the populations (a new distribution with different masses would represent a different state).

**Rationale:** The mass-based moving bin strategy is well-suited for processes where mass changes continuously (like condensation/evaporation) because it updates particle size smoothly. By keeping all particles in a bin at a single mass that moves with growth, the method eliminates the need to redistribute particles across fixed size bins, thereby avoiding numerical artifacts (no artificial broadening of the distribution). It provides a clear physical interpretation: each bin’s particles grow in place, and their size (mass) increases deterministically with added mass. Total number $N=\sum_i C_i$ remains constant during purely condensational growth, as expected, while total mass increases. (If one instead tried to use fixed mass bins for condensation, particles would shift bins, potentially causing numerical dispersion, which the moving-bin approach circumvents.) This strategy assumes a single species or a uniform composition for particles – density $\rho$ is typically uniform here, so growth does not change composition, only mass. It’s a simplification that treats each bin as internally well-mixed and defined solely by mass.

## Radii-Based Moving Bin Strategy

In the **Radii-Based Moving Bin** approach, each bin is defined by a characteristic **particle radius** $r_i$ instead of mass. The distribution stores radii for bins, and $C_i$ gives the particle count in each bin. This representation is intuitive since aerosol size distributions are often described in terms of particle diameter or radius. As a moving-bin method, the bin radii are updated when mass is added, ensuring particles grow without jumping between bins.

* **Radius–Mass Relationship:** For a particle of radius $r_i$ and density $\rho$, the mass is

$$
m_i = \frac{4}{3}\pi r_i^3 \rho
$$

Equivalently, given a bin’s radius, one can compute mass per particle as $m_i = \rho \cdot V_i = \rho \cdot \frac{4}{3}\pi r_i^3$. All particles in bin *i* share this radius and mass. The total volume of a particle in bin *i* is $V_i = \frac{4}{3}\pi r_i^3$, and total mass in the bin is $m_i C_i = \frac{4}{3}\pi r_i^3 \rho\, C_i$.
* **Mass and Radius Calculations:** The **distribution variable** here is radius, so by definition $r_i$ is the particle size for bin *i*. The strategy uses these radii directly for any size-dependent calculations (e.g., cross-sectional area, deposition rates). When needed, the mass per particle can be obtained as above. Conversely, to get the radius from a given mass in this context, one inverts the sphere formula: $r = \Big(\frac{3m}{4\pi\rho}\Big)^{1/3}$. This is applied whenever the bin’s mass changes.
* **Mass Addition (`add_mass`):** Adding mass causes each bin’s radius to **increase**, since particles grow. If a mass $\Delta M_i$ is added uniformly to bin *i*, each particle in that bin gains $\Delta m_i = \frac{\Delta M_i}{C_i}$ mass. The strategy computes the new volume per particle as $V_i^{\text{new}} = V_i + \frac{\Delta m_i}{\rho}$ (adding mass increases volume by $\Delta m/\rho$). Then it updates the radius: $r_i^{\text{new}} = \Big(\frac{3\,V_i^{\text{new}}}{4\pi}\Big)^{1/3}$. In code, this is done by first finding initial volumes $V_i = \frac{4}{3}\pi r_i^3$, then $V_i^{\text{new}} = V_i + \Delta m_i/\rho$, and finally $r_i^{\text{new}} = (3V_i^{\text{new}}/(4\pi))^{1/3}$. The number of particles $C_i$ remains unchanged. This approach ensures that growth *moves the bin radius* to larger sizes rather than spreading particles out. It is equivalent to the mass-based method but viewed in the radius domain.
* **Concentration Addition (`add_concentration`):** To add new particles, their size distribution must align with the existing radii. If an “added” population has the same radii $r_i$ as the current bins (e.g. essentially duplicating the distribution), their concentrations can be added to each bin: $C_i \leftarrow C_i + \Delta C_i$. But if the incoming particles have different radii (even slightly), the method raises an error because one cannot merge them without altering bin definitions. Thus, concentration can be increased only by adding particles of identical size to those already represented. This keeps each bin’s radius fixed unless mass growth is explicitly invoked.

**Rationale:** The radii-based moving bin strategy is useful when one wants to directly track particle size (radius) as the primary quantity. It is often more straightforward to relate to measured size distributions (e.g., dN/dlogD). This approach leverages the same moving-bin philosophy: particle size bins *move along the radius axis* when mass is gained or lost, avoiding the need for rebinning. The absence of fixed bin boundaries means condensation or evaporation can be handled without generating numerical “smearing” of the distribution. All growth is captured by continuously updating $r_i$. The trade-off is that adding mass requires a calculation of how much the radius must change, which is inherently non-linear ($r \propto m^{1/3}$). However, since the formula for spherical particles is well-defined, this is handled analytically as above. As with mass-based bins, pure condensational growth does not change $C_i$; total number stays constant and total mass increases. The approach assumes uniform composition (single species or well-mixed particles) per bin, since a single density $\rho$ is used for all mass–radius conversions in each bin.

## Speciated Mass Moving Bin Strategy

The **Speciated Mass Moving Bin** strategy extends the mass-based approach to **multi-component aerosols**. Here each bin holds particles that contain multiple species (chemical components), each with its own density. The distribution is represented by a matrix or vector for each bin: $m_{i,j}$ is the mass of species *j* in a particle of bin *i*. The number concentration in bin *i* is $C_i$ as before. This strategy tracks the detailed composition per bin, allowing computation of particle properties like total mass and radius from the sum of contributions of all species.

* **Distribution Representation:** Instead of a single mass value, each bin carries a **mass vector** $\mathbf{m}_i = (m_{i,1}, m_{i,2}, ..., m_{i,S})$ for \$S\$ species. For example, a bin might represent particles containing sulfate, organic carbon, and black carbon mass all at once. Each species *j* has a known density $\rho_j$. The strategy assumes particles in the same bin have the same composition vector (internal mixture for that bin). The total mass of a particle in bin *i* is

$$
m_i^{\text{total}} = \sum_{j=1}^{S} m_{i,j}
$$

The total mass in the bin is $M_i = C_i \sum_j m_{i,j}$.
* **Radius Calculation:** Given the species masses and densities, the **particle radius** in bin *i* is determined by the total volume of the particle. Each species contributes volume $V_{i,j} = \frac{m_{i,j}}{\rho_j}$. Summing volumes gives total particle volume

$$
V_i = \sum_{j=1}^S \frac{m_{i,j}}{\rho_j}
$$

The radius is then

$$
r_i = \left(\frac{3 V_i}{4\pi}\right)^{1/3}
$$

This ensures that low-density species (which occupy more volume per unit mass) appropriately increase the particle size. The approach captures how changing composition affects size: e.g., adding a less dense species yields a larger radius than adding the same mass of a dense species.
* **Mass per Species (`get_species_mass`):** The strategy provides the species-resolved mass distribution directly. Essentially, *get\_species\_mass* returns the distribution matrix ${m_{i,j}}$ itself, since that is already the mass of each species in each bin’s particles. If needed, one can also compute total mass per particle $m_i^{\text{total}}$ or other moments from this representation.
* **Mass Addition (`add_mass`):** When additional mass is added to the aerosol, it may be **speciated** (e.g., condensation of a specific vapor adds mass to one species like sulfate). The `add_mass` method allows an *added\_mass* input that is structured like the distribution (an array of shape \[bins, species]) indicating how much mass of each species to add per bin. The added mass is distributed equally among the \$C\_i\$ particles in bin *i*. For each species *j*, if \$\Delta M\_{i,j}\$ mass is added to bin *i* (total), then each particle gains \$\Delta m\_{i,j} = \Delta M\_{i,j}/C\_i\$ of that species (assuming \$C\_i>0\$). The distribution is then updated: \$m\_{i,j} \leftarrow m\_{i,j} + \Delta m\_{i,j}\$ for all species, and negative values are floored at 0 if any were to occur. In vector form,

$$
\mathbf{m}_i^{\text{new}} = \mathbf{m}_i + \frac{\Delta \mathbf{M}_i}{C_i}
$$

where \$\Delta \mathbf{M}\_i\$ is the vector of added mass to bin *i*. This **moves the bin in multi-dimensional composition space** – the bin’s particle becomes larger and possibly changes composition (e.g., more sulfate fraction if sulfate was added). The bin’s radius is implicitly updated next time it’s computed from the new volumes. Importantly, \$C\_i\$ remains the same; no new particles are introduced by condensation alone.
* **Concentration Addition (`add_concentration`):** Adding a new population of particles into this multi-species distribution is only feasible if the new particles have the **same composition vector** as an existing bin (otherwise they represent a state not currently in the distribution). The method enforces that the *added\_distribution* (the \$\mathbf{m}\_i\$ values of the incoming population) matches the current distribution array shape and values. In practice, this means one can only increase \$C\_i\$ for bins that have identical composition and mass as the particles being added. If the match is exact (within a tolerance), the concentrations are summed: \$C\_i \leftarrow C\_i + \Delta C\_i\$. If not, it raises an error – the two distributions can’t be merged without introducing a new bin or altering composition. This strict criterion ensures that we don’t accidentally combine dissimilar particle types. Essentially, one can **merge or superimpose populations** only if they occupy the same bins in mass-composition space.

**Rationale:** The speciated mass moving bin strategy is powerful for **internally mixed multicomponent aerosols**. It provides a way to represent particle composition in each size bin, which is crucial for processes like hygroscopic growth, chemical reactions, or optical property calculations that depend on composition. The moving-bin nature (in multi-dimensional space) means that when mass of a certain species is added, the bin’s representative composition changes smoothly, rather than having to split particles into different bins or modes. All particles in a bin remain identical in composition, which is a common assumption in sectional models (each bin is internally well-mixed). This strategy ensures that total mass of each species is conserved as mass is added and that the resulting size increase is properly accounted for via volumes. By preserving the detailed species breakdown, one can compute, for instance, the bulk density of a particle (from total mass and volume) or track how each species’ mass fraction evolves. The limitation is that one cannot easily merge dissimilar distributions; new particle types (with new composition or size) would formally require introducing new bins or using the particle-resolved approach. However, within its framework, this strategy is consistent with physically meaningful updates: e.g., adding sulfuric acid vapor will increase the sulfate mass in each particle and make them grow in size, all while keeping their number and original identity (bin) intact.

## Particle-Resolved Speciated Mass Strategy

The **Particle-Resolved Speciated Mass** approach represents the extreme of resolution: instead of grouping particles into bins, it treats each particle (or each representative “super-particle”) individually, including its full composition. In practice, the distribution is a list of particles, where each particle *k* has a composition vector $\mathbf{m}_k = (m_{k,1}, m_{k,2}, ..., m_{k,S})$. The model also keeps a corresponding array of particle counts or weights $C_k$, where $C_k$ might be the number of real particles represented by the model’s particle *k*. This strategy allows fully **heterogeneous mixtures** – each particle can have a unique size and composition, unlike bin methods that assume internal sameness per bin.

* **Distribution Representation:** The state is defined by $\{\mathbf{m}_k, C_k\}_{k=1...N_p}$ for \$N\_p\$ particles in the simulation. If \$S\$ species are considered, \$\mathbf{m}*k\$ has \$S\$ components for particle \$k\$. For example, particle 1 might be a large particle rich in species A, particle 2 a smaller particle mostly species B, etc. The **total mass** of particle \$k\$ is \$m\_k^{\text{total}}=\sum*{j} m\_{k,j}\$, and its **radius** can be computed as \$r\_k = \Big(\frac{3}{4\pi}\sum\_j \frac{m\_{k,j}}{\rho\_j}\Big)^{1/3}\$ (summing volumes of each species). The total number concentration represented is \$N\_{\text{tot}} = \sum\_{k} C\_k\$. In a fully “particle-resolved” sense one might set each \$C\_k=1\$ (each entry is an actual particle), but often \$C\_k\$ can be >1 if using weighting (super-particles) for efficiency.
* **Mass and Radius Computation:** To get each particle’s radius, the strategy sums its species volumes as above. If a particle has only one species (distribution array is 1D), the radius simplifies to \$r\_k = (3 m\_k/(4\pi \rho))^{1/3}\$. For multi-species (distribution 2D), \$r\_k = (3\sum\_j m\_{k,j}/\rho\_j / (4\pi))^{1/3}\$. The **mass per species** for a given particle is directly \$\mathbf{m}*k\$ (the distribution itself stores species masses). Because each particle is considered separate, one can calculate aggregate properties like total mass of species \$j\$ as \$\sum\_k m*{k,j} C\_k\$, or size distribution by binning these particle sizes if needed.
* **Mass Addition (`add_mass`):** When mass is added in this framework, it can be targeted to individual particles or broadly applied. For instance, condensation might add a mass \$\Delta m\_{k,j}\$ of species \$j\$ to each particle \$k\$. The `add_mass` method takes an array *added\_mass* of the same shape as the distribution (i.e., \[particles, species] or \[particles] for single species) and adds it to the particles’ masses. If \$C\_k>1\$, meaning particle \$k\$ represents multiple real particles, the added mass is interpreted as **total mass** to distribute among those \$C\_k\$ particles. In implementation, they multiply the particle’s current mass by its concentration to get total bin mass, add the incoming mass, then divide by concentration to get the new per-particle mass. In formula:

$$
\mathbf{m}_k^{\text{new}} = \frac{\mathbf{m}_k C_k + \Delta \mathbf{M}_k}{C_k}
$$

where \$\Delta \mathbf{M}\_k\$ is the vector of mass added to all \$C\_k\$ particles represented by entry \$k\$. This ensures each real particle gains an equal share. If a particle had zero count (\$C\_k=0\$), it cannot get mass (handled by zero-division protection in code). Any resulting negative masses are floored at zero. After adding mass, the method checks if any particle’s *total* mass dropped to zero (which could happen if negative mass was allowed for evaporation), and if so, it sets \$C\_k=0\$ for that particle (effectively removing that particle from the distribution). Thus, particle counts are adjusted so that any “empty” particle is considered gone.
* **Concentration Addition (`add_concentration`):** In a particle-resolved scheme, adding concentration typically means introducing new particle entries (or increasing the weight of existing ones). The `add_concentration` method handles merging or adding particle records. If the added particles have the same composition and size as an existing particle entry, one could simply increase \$C\_k\$. If not, new entries must be created. This method expects either **all new particles to have equal weight** or to be unweighted single additions. In practice, it normalizes the existing particles’ concentrations and the new ones to a common scale: for example, if all current particles have \$C\_k=1\$ or some uniform value, it can add new ones with \$C=1\$ each. It ensures the added concentrations are either all ones or all the same value, rescaling if necessary to match the scale of existing particles. Then, any “empty slots” in the distribution array (particles with \$C\_k=0\$ from previous removals) are filled first with new particles’ data. If more new particles remain, it appends them to the distribution arrays as entirely new entries. For example, if 5 new particles are nucleated, the method will insert their composition vectors into the array, assign them each (normalized) concentration (often making them each represent one real particle), and increase \$N\_{\text{tot}}\$. This procedure preserves the individual nature of each particle added. It does not combine different particles into one bin; each new particle remains a separate entry (unless it exactly matched an existing particle’s composition, in which case merging would have been possible by simply raising that one’s \$C\_k\$).

**Rationale:** The particle-resolved approach (sometimes called **Lagrangian or Monte Carlo method** in aerosol modeling) captures the **full diversity of particle compositions and sizes**. It imposes no artificial grouping – each particle can be unique. This is crucial when modeling processes like coagulation or selective chemistry where assuming particles in a bin are identical might introduce error. For instance, two particles with the same total mass but different composition can behave differently as cloud condensation nuclei; a particle-resolved model can handle that, whereas a bin model might not distinguish them. The cost is computational: potentially many particles must be tracked. The `add_mass` operation in this strategy directly embodies physical reality: if vapor condenses, you increase the mass of each particle; if a particle fully evaporates (mass goes to zero), it is removed (concentration set to 0). The `add_concentration` operation corresponds to introducing new particles (e.g. from nucleation or emission) one-by-one or in groups. By normalizing weights, the implementation avoids issues where, say, you add a set of particles that all have weight 100 while existing ones have weight 1 – it will rescale so that effectively you treat each added entry as new individual particles relative to the current population. This keeps the interpretation consistent (often one tries to keep all representative particles at similar weights in particle-resolved methods to maximize statistical accuracy). Overall, this strategy is the most detailed and physically faithful representation since it doesn’t require assumptions of internal mixing or a predefined bin structure – but it requires careful bookkeeping of each particle’s properties.

## "Grow-in-Place" Approach for Discrete PMF Distributions

In a **“grow in place” strategy for a discrete probability mass function (PMF) representation**, one would keep the bin positions (masses or sizes) fixed and account for added mass by increasing the **particle concentration in those bins** rather than moving the bins. This approach is a conceptual alternative to moving-bin methods. Imagine a fixed grid of bin masses $\{m_b\}$. If particles gain mass through condensation, instead of shifting to a higher-mass bin or changing the bin’s representative mass, we *pretend the bins are static* and allocate the added mass as if it creates additional particles of the same original size. In effect, particles “grow” by multiplying in number at the same size, rather than by becoming larger – hence “grow in place.”

* **Method Description:** For each bin \$b\$ with fixed characteristic mass \$m\_b\$ and \$N\_b\$ particles, an added mass \$\Delta M\_b\$ (total) is interpreted as **new particles of mass \$m\_b\$**. The bin’s mass \$m\_b\$ remains unchanged, but the concentration increases to \$N\_b' = N\_b + \Delta N\_b\$. The increment in number, \$\Delta N\_b\$, is chosen so that the mass increase is accounted for: \$\Delta N\_b \cdot m\_b = \Delta M\_b\$. Equivalently,

$$
\Delta N_b = \frac{\Delta M_b}{m_b}
$$

After growth, the bin still contains particles of mass \$m\_b\$, but there are more of them (if \$\Delta M\_b>0\$). This ensures the **total mass** in the bin increases by \$\Delta M\_b\$, as required, but it does **not** increase any individual particle’s mass. The added mass has been converted into additional particles at the original size.
* **Conservation Properties:** This approach by construction conserves mass exactly (all \$\Delta M\_b\$ is accounted as new particle mass). However, it **does not conserve particle number** in physical terms, since condensation should not create new particles. Here, total number \$N\_{\text{tot}} = \sum\_b N\_b\$ would increase whenever mass is added. The method essentially violates the typical rule that condensation leaves \$N\_{\text{tot}}\$ constant. In a PMF sense, one might argue it preserves the shape of the size distribution (bins stay where they are) at the expense of adding “weight” to the distribution. If the distribution were normalized as a probability distribution, one would have to re-normalize after growth to keep it a valid PMF. But in an absolute sense, particle count changes.
* **Physical Interpretation:** The “grow-in-place” discrete method is **not physically realistic for condensation**, since mass growth of existing particles does not generate new particles. Rather, this approach might be viewed as a numerical expedient or hypothetical scenario. It could represent, for example, a model that chooses not to shift bin positions and instead approximates growth by injecting tiny particles into those bins to mimic mass increase. In reality, those “new” particles could be thought of as fragments of the original particles’ mass growth distributed among the bin. This interpretation breaks the one-to-one link between bins and real particle populations, so it’s rarely used in rigorous aerosol dynamics. It may be more relevant in contexts where a distribution is updated in a ad-hoc way or where number change is acceptable (e.g. treating mass addition as a source of new particles of the same size).
* **Use Cases and Limitations:** Since this method keeps bin sizes fixed, it **avoids moving the grid** and thus trivializes the advection of the distribution in size space – there is no advection, only source terms in bins. It completely avoids numerical dispersion from moving between bins (because nothing moves). However, it introduces a potentially huge error in particle number. For instance, if a bin’s particles double in mass, the grow-in-place method would say the number of particles doubled while each stayed at the original mass \$m\_b\$ – clearly not a faithful representation of actual growth (actual physics: number unchanged, mass doubled; this method: number doubled, mass unchanged). Therefore, while mathematically one can define this procedure, it’s more of a theoretical construct. It might be useful for sensitivity tests or simplified models where keeping a fixed grid is crucial and some effective “source” of number is tolerable. But one must then track that particle number is artificially increased. If desired, one could impose a renormalization to force number conservation (for example, after adding mass, scale down \$N\_b\$ to the original total \$N\_{\text{tot}}\$). Such renormalization would distribute the added mass among fewer particles implicitly making particles effectively larger, which circles back to needing to grow the size. In summary, the discrete grow-in-place approach sacrifices the physical invariant (particle count) to maintain a fixed coordinate system for the distribution.

*Mathematical note:* One can illustrate the grow-in-place update for a single bin. Suppose bin with mass \$m\$ has \$N\$ particles (mass in bin \$M\_{\text{bin}} = Nm\$). Add mass \$\Delta M\$. Grow-in-place says: \$m\$ stays \$m\$, \$N\$ becomes \$N+\Delta M/m\$. Total mass becomes \$(N+\Delta M/m)m = Nm + \Delta M\$, as required. If this were a probability mass function (PMF) normalized to 1, one would instead allocate an increased probability weight to that mass \$m\$. The distribution’s shape (as a function of mass) would spike upward at that same \$m\$. In an absolute distribution, it’s an increase in counts at one size. This is analogous to adding a delta-function of mass at the original bin location to represent the condensate, rather than shifting the delta-function to a new mass. The **numerical dispersion** is zero (no spreading to neighboring bins), but the **physical fidelity** is poor regarding number conservation.

## "Grow-in-Place" Method for Continuous PDF Distributions

For a **continuous distribution (PDF-based) representation**, a “grow in place” strategy corresponds to using a **fixed grid in the size/mass domain** and handling condensational growth as a flux of distribution between those fixed bins, rather than moving the grid points. In a true continuous view, particle growth under condensation is described by a continuity (transport) equation in size-space. A fixed-bin (Eulerian) numerical scheme solves this by moving distribution **between** bins over time. The term “grow in place” here implies we do not redefine or shift the bin boundaries; instead, we compute how the distribution function \$f(x,t)\$ (where \$x\$ could be mass or radius) changes on the fixed \$x\$ grid due to growth. Crucially, this must be done in a way that **preserves the normalization** of the distribution, meaning the total number of particles \$\int f(x,t)dx\$ remains constant (assuming no new particle sources or losses, just growth).

* **Continuity Equation Basis:** The governing equation for condensational growth (no sources/sinks of particles) is:

$$
\frac{\partial f(x,t)}{\partial t} + \frac{\partial}{\partial x}\left(G(x,t) f(x,t)\right) = 0.
$$

Here \$G(x,t) = dx/dt\$ is the growth rate (e.g., how fast particle mass or radius increases). This equation states that as particles grow (move to larger \$x\$), the distribution \$f(x)\$ is advected accordingly, and total number is conserved (the equation is in conservation form). In an Eulerian discretization, one divides \$x\$ into fixed bins and treats the \$\frac{\partial}{\partial x}(Gf)\$ term as a **flux** of particles from one bin to the next. A “grow-in-place” algorithm will calculate how much of \$f\$ in bin \$i\$ moves to bin \$i+1\$ over a time step \$\Delta t\$ due to growth. By ensuring that exactly that amount is removed from bin \$i\$ and added to bin \$i+1\$, the total \$\int f dx\$ stays constant.
* **Implementing Mass Addition:** Suppose each particle increases in mass by a small amount over \$\Delta t\$. In a fixed-bin scheme, this means a fraction of the particles originally in a mass bin will end up in the next bin. Concretely, if bin \$i\$ covers \[\$m\_i, m\_{i+!1}\$) and particles at \$m\_i\$ grow to \$m\_i+\delta m\$ in the step, some will cross into bin \$i+1\$. The algorithm computes the fraction \$\alpha\$ of bin \$i\$’s population that moves out (based on \$G\$ and the bin width). Then it reduces bin \$i\$’s concentration by that fraction and increases bin \$i+1\$’s concentration by the same fraction (or adds a continuous amount to \$f\$ in that bin). This is analogous to an upwind differencing scheme for the advection equation. **No particle number is lost or gained:** it’s merely redistributed to higher mass bins. In this sense, particles **grow into** the next bin rather than the bin moving with them.
* **Normalization Preservation:** By construction, the flux form guarantees number conservation. Any decrement in \$f\$ at one bin is an increment in a neighboring bin. Numerically, one must be careful with the end of the distribution (the largest bin, where particles may grow out of the domain – typically handled by extending the domain or having an open boundary). But within the grid, the sum \$\sum\_i f\_i \Delta x\_i\$ (discrete form of \$\int f dx\$) remains constant to within numerical precision. In other words, the *area under the number distribution* is invariant, satisfying the normalization. This is critical: adding mass should not change the total number of particles, and the method ensures that by transferring \$f\$ rather than creating or destroying it.
* **Comparison to Moving Bin:** In a moving-bin approach, one would increase the bin’s \$x\$ coordinate and possibly keep the population in the same bin index. In the fixed-grid (Eulerian grow-in-place) approach, the bin coordinates are fixed, so the population profile \$f(x)\$ **shifts** through the grid over time. This can be viewed as the distribution “flowing” to the right (toward larger sizes). There is potential for **numerical diffusion** if the grid is coarse or the time step is large, meaning the distribution might artificially spread out. High-order schemes or very fine bins can mitigate this. The moving-bin approach largely avoids that by carrying the bin along the flow, but at the cost of continuously changing the grid.
* **Mass Addition Interpretation:** From a different angle, one can consider how total mass increases while number stays fixed. The continuous distribution \$f(x)\$ initially describes some number per unit \$x\$. After condensation, \$f(x)\$ might decrease at smaller \$x\$ and increase at larger \$x\$. The **area** under \$f\$ is the same, but it “slides” to higher \$x\$. For example, if \$f(m)\$ is initially a delta-function at \$m\_0\$ (all particles of mass \$m\_0\$), after some growth it will become a delta-function at \$m\_1>m\_0\$ in the ideal continuous limit (all particles grew to \$m\_1\$). In a fixed-bin discrete approximation, one would see \$f(m\_0)\$ drop and \$f\$ at neighboring bins raise, approximating a shifted delta. The normalization (area) is unchanged. If growth happens slowly over many small steps, the numerical method will move the distribution gradually bin by bin, mimicking a translation of the distribution.
* **Preserving PDF Shape vs. Number:** A subtle point is that if one were using a *normalized probability density* (integral =1), preserving normalization literally means keeping it normalized to 1. In our context, \$f(x)\$ usually represents an absolute number distribution (integral = total number). “Preserving normalization” thus is equivalent to conserving total number. The algorithm inherently does that via the continuity equation. There’s no need for post-step renormalization (which would indicate numerical loss/gain of particles) if the scheme is conservative. This is an advantage of formulating the growth as an advective flux: it enforces the conservation law in the discretized system.

**In summary,** the grow-in-place method for a PDF-based aerosol model is essentially the **classical fixed-sectional (Eulerian) approach** to condensational growth. One keeps bins fixed and lets the distribution function evolve by moving values between bins. Mass is added to the system in the sense that the distribution shifts to larger mass values (thus particles carry more mass), but the algorithm ensures the total number (area under \$f\$) remains constant. This approach is widely used in aerosol models that solve the aerosol general dynamic equation on a fixed grid. It contrasts with moving-bin (Lagrangian) methods in implementation but should yield the same physical result if done with sufficient resolution: particles grow to larger size without any spurious loss or creation of particle count. The key challenges are maintaining accuracy (minimizing numerical diffusion) and choosing time-steps small enough to capture the flux between bins properly. When those are addressed, the fixed-grid method accurately preserves normalization and tracks mass addition by redistributing the continuous size distribution accordingly.
