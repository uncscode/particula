
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Fitting Kappa-HGF from Light Extinction &#8212; Particula Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/light_scattering/kappa_vs_extinction';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Scattering Truncation Corrections" href="scattering_truncation.html" />
    <link rel="prev" title="Scattering for Humidified Particles" href="humid_scattering.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/placeholder.png" class="logo__image only-light" alt="Particula Book - Home"/>
    <script>document.write(`<img src="../../_static/placeholder.png" class="logo__image only-dark" alt="Particula Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Getting started
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tour</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../tour/part-tour.html">Particula tour</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../distribution_statistics.html">Distribution statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distribution_coagulation.html">Distribution coagulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distribution_evolution.html">Distribution evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distribution_ambient.html">Distributions</a></li>

<li class="toctree-l1"><a class="reference internal" href="../ionparticle_coagulation.html">Ion–particle coagulation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../streamlake/particula_data.html">Data in Particula</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../streamlake/loading_data_part1.html">Loading Part 1: Into &amp; 1D Data</a></li>



<li class="toctree-l2"><a class="reference internal" href="../streamlake/loading_data_part2.html">Loading Part 2: Sizer Data</a></li>

<li class="toctree-l2"><a class="reference internal" href="../streamlake/loading_data_part3.html">Loading Part 3: Lake</a></li>



<li class="toctree-l2"><a class="reference internal" href="../streamlake/loading_data_part4.html">Loading Part 4: Settings Files</a></li>

<li class="toctree-l2"><a class="reference internal" href="../streamlake/stream_stats_part1.html">Stream: Averaging and Outliers</a></li>



<li class="toctree-l2"><a class="reference internal" href="../streamlake/stream_stats_size_distribution_part2.html">Size Distribution Stats</a></li>



</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../wall_loss_section.html">Chamber Wall Loss Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../wall_loss/chamber_smps_data.html">Chamber Analysis</a></li>

<li class="toctree-l2"><a class="reference internal" href="../wall_loss/wall_loss_forward_simulation.html">Chamber Forward Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wall_loss/forward_fit_simple.html">Simple Wall Loss Fit</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lagrangian/lagrangian_intro.html">Lagrangian Particle Model</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lagrangian/basic_lagrangian_box.html">Introduction to the Lagrangian Box Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lagrangian/sweep_and_prune.html">Sweep and Prune Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lagrangian/friction_force.html">Realistic Drag, Mass, and Velocity</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../equilibria/equilibria_intro.html">Equilibria of Aerosols</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../equilibria/activity_part1.html">Activity Example</a></li>

<li class="toctree-l2"><a class="reference internal" href="../equilibria/equilibria_part1.html">Liquid Vapor Equilibrium</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="aerosol_optics_intro.html">Introduction to Aerosol Optics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mie_basics.html">Mie Scattering</a></li>
<li class="toctree-l2"><a class="reference internal" href="humid_scattering.html">Scattering for Humidified Particles</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Fitting Kappa-HGF from Light Extinction</a></li>
<li class="toctree-l2"><a class="reference internal" href="scattering_truncation.html">Scattering Truncation Corrections</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../documentation/environment.html">The <code class="docutils literal notranslate"><span class="pre">Environment</span></code> Class</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/utilities/dilution_loss.html"><code class="docutils literal notranslate"><span class="pre">dilution_loss</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/utilities/dynamic_viscosity.html"><code class="docutils literal notranslate"><span class="pre">dynamic_viscosity</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/utilities/mean_free_path.html"><code class="docutils literal notranslate"><span class="pre">mean_free_path</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/vapor.html">The <code class="docutils literal notranslate"><span class="pre">Vapor</span></code> Class</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../documentation/particle.html">The <code class="docutils literal notranslate"><span class="pre">Particle</span></code> Classes</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/utilities/distribution_discretization.html"><code class="docutils literal notranslate"><span class="pre">distribution_discretization</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/utilities/radius_cutoff.html"><code class="docutils literal notranslate"><span class="pre">radius_cutoff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/utilities/particle_mass.html"><code class="docutils literal notranslate"><span class="pre">particle_mass</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/utilities/knudsen_number.html"><code class="docutils literal notranslate"><span class="pre">knudsen_number</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/utilities/slip_correction.html"><code class="docutils literal notranslate"><span class="pre">slip_correction</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/utilities/friction_factor.html"><code class="docutils literal notranslate"><span class="pre">friction_factor</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/utilities/dimensionless_coagulation.html"><code class="docutils literal notranslate"><span class="pre">dimensionless_coagulation</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../documentation/utilities/utilities_overview.html">Utilities Functions</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/utilities/convert_size_dist_scales.html">Converting Distributions</a></li>


</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Strategic Plan</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../strategic_plan/strategic_planning_FY24.html">FY24 Plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../strategic_plan/Aerosol_patterns.html">Program Outline Revision Draft</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Prototype</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../documentation/base/base_overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/base/gas.html">Gases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/base/base_particle.html">Strategies in Particle Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/base/base_aerosol.html">Aerosol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/base/base_runnable_process.html">Modeling Aerosol Dynamics with Runnable Processes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html">Contributor Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/uncscode/particula/v0.0.10?urlpath=lab/tree/docs/examples/light_scattering/kappa_vs_extinction.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/uncscode/particula/blob/v0.0.10/docs/examples/light_scattering/kappa_vs_extinction.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/uncscode/particula" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/uncscode/particula/edit/v0.0.10/docs/examples/light_scattering/kappa_vs_extinction.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/uncscode/particula/issues/new?title=Issue%20on%20page%20%2Fexamples/light_scattering/kappa_vs_extinction.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/examples/light_scattering/kappa_vs_extinction.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Fitting Kappa-HGF from Light Extinction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-synthetic-data-for-kappa-hgf-analysis">Generating Synthetic Data for Kappa-HGF Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hygroscopic-growth-parameters">Hygroscopic Growth Parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#size-distribution">Size Distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-steps">Calculation Steps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-light-extinction-for-hygroscopic-growth">Simulating Light Extinction for Hygroscopic Growth</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-kappa-hgf-to-dry-aerosol-data">Fitting Kappa-HGF to Dry Aerosol Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#insensitivity-to-humidity-in-sizer-and-extinction-measurements">Insensitivity to Humidity in Sizer and Extinction Measurements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-kappa-hgf-under-varied-humidity-conditions">Fitting Kappa-HGF under Varied Humidity Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-insights">Key Insights</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examining-the-impact-of-dry-refractive-index-on-kappa-hgf-estimation">Examining the Impact of Dry Refractive Index on Kappa-HGF Estimation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robustness-of-kappa-hgf-estimation-against-particle-number-variations">Robustness of Kappa-HGF Estimation Against Particle Number Variations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstrating-insensitivity-through-particle-number-variation">Demonstrating Insensitivity through Particle Number Variation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implications-for-ambient-aerosol-measurements">Implications for Ambient Aerosol Measurements</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-kappa-hgf-fitting-notebook">Summary of Kappa-HGF Fitting Notebook</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#synthetic-data-generation">Synthetic Data Generation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kappa-hgf-fitting">Kappa-HGF Fitting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions-and-implications">Conclusions and Implications</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="fitting-kappa-hgf-from-light-extinction">
<h1>Fitting Kappa-HGF from Light Extinction<a class="headerlink" href="#fitting-kappa-hgf-from-light-extinction" title="Link to this heading">#</a></h1>
<p>In the field of atmospheric science, understanding the hygroscopic growth of aerosol particles is crucial for predicting their impact on climate, weather patterns, and human health. The kappa-Hygroscopic Growth Factor (kappa-HGF) is a parameter that quantifies the ability of aerosol particles to absorb water under varying levels of relative humidity. However, kappa-HGF is not measured directly in atmospheric observations. Instead, researchers infer this parameter by analyzing changes in aerosol properties, such as light extinction, diameter growth, or light scattering, as a function of humidity.</p>
<p>This notebook focuses on deriving kappa-HGF from light extinction measurements at different humidity levels. Light extinction, which encompasses both scattering and absorption by aerosol particles, is a fundamental optical property that can significantly vary with particle size and composition, especially as particles undergo hygroscopic growth in humid conditions. By comparing light extinction under low and high humidity conditions, we can back-calculate kappa-HGF, offering insights into the water uptake and swelling behavior of aerosols in the atmosphere.</p>
<p>The methodology and analyses presented here for light extinction can be analogously applied to other aerosol properties affected by humidity changes. Understanding these dynamics is key to improving our models of aerosol-cloud interactions, radiative forcing, and visibility impairment.</p>
<p><strong>Imports</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># particula imports</span>
<span class="kn">from</span> <span class="nn">particula.util</span> <span class="kn">import</span> <span class="n">convert</span><span class="p">,</span> <span class="n">distribution_discretization</span>
<span class="kn">from</span> <span class="nn">particula.data.process</span> <span class="kn">import</span> <span class="n">kappa_via_extinction</span>
</pre></div>
</div>
</div>
</div>
<section id="generating-synthetic-data-for-kappa-hgf-analysis">
<h2>Generating Synthetic Data for Kappa-HGF Analysis<a class="headerlink" href="#generating-synthetic-data-for-kappa-hgf-analysis" title="Link to this heading">#</a></h2>
<p>To conduct a meaningful analysis of kappa-HGF (Hygroscopic Growth Factor) based on light extinction, we first need to simulate synthetic data that closely mimics atmospheric aerosol properties. This involves creating a size distribution of aerosol particles and calculating their light extinction coefficients under different humidity conditions.</p>
<section id="hygroscopic-growth-parameters">
<h3>Hygroscopic Growth Parameters<a class="headerlink" href="#hygroscopic-growth-parameters" title="Link to this heading">#</a></h3>
<p>For our synthetic dataset, we consider ammonium sulfate as the aerosol composition with a kappa value of 0.61. We examine the particle behavior at three distinct relative humidity (RH) levels: 30%, 60%, and 90%, representing low, mid, and high water activity scenarios, respectively.</p>
</section>
<section id="size-distribution">
<h3>Size Distribution<a class="headerlink" href="#size-distribution" title="Link to this heading">#</a></h3>
<p>The synthetic size distribution is modeled as a bimodal log-normal distribution, capturing the diversity in particle sizes typically observed in atmospheric aerosols. The distribution spans from 20 nm to 1000 nm with 500 discrete points, encompassing a wide range of aerosol sizes. The distribution is characterized by two modes at 100 nm and 500 nm and a geometric standard deviation of 1.25, simulating a realistic atmospheric aerosol size distribution.</p>
<section id="calculation-steps">
<h4>Calculation Steps<a class="headerlink" href="#calculation-steps" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>Volume Conversion</strong>: Convert the diameters from the base distribution to volumes, facilitating the subsequent calculation of water volume absorbed by the particles at different RH levels.</p></li>
<li><p><strong>Water Volume Calculation</strong>: For each RH level, calculate the volume of water absorbed by the particles, leveraging the kappa value to simulate hygroscopic growth.</p></li>
<li><p><strong>Diameter Adjustment</strong>: Adjust the particle diameters based on the absorbed water volume to obtain new diameters that reflect hygroscopic growth at each RH level.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hygroscopic growth parameters</span>
<span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.61</span>  <span class="c1"># Kappa value for ammonium sulfate</span>
<span class="n">water_activity_low</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># Low water activity (30% RH)</span>
<span class="n">water_activity_mid</span> <span class="o">=</span> <span class="mf">0.6</span>  <span class="c1"># Mid water activity (60% RH)</span>
<span class="n">water_activity_high</span> <span class="o">=</span> <span class="mf">0.9</span>  <span class="c1"># High water activity (90% RH)</span>

<span class="c1"># Define the range and resolution of particle diameters (in nanometers)</span>
<span class="n">diameters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>  <span class="c1"># From 20 nm to 1000 nm with 500 points</span>

<span class="c1"># Standard deviation of the log-normal distribution (dimensionless)</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.25</span>

<span class="c1"># Define the modes (peak diameters) for a bimodal distribution</span>
<span class="n">modes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>

<span class="c1"># Total number of particles in the distribution</span>
<span class="n">number_total</span> <span class="o">=</span> <span class="mf">1e3</span>

<span class="c1"># Generate a log-normal probability density function (pdf) with an area</span>
<span class="c1"># equal to 1</span>
<span class="n">pdf_dist</span> <span class="o">=</span> <span class="n">distribution_discretization</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span>
    <span class="n">interval</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>  <span class="c1"># Array of diameters over which to compute the distribution</span>
    <span class="n">disttype</span><span class="o">=</span><span class="s2">&quot;lognormal&quot;</span><span class="p">,</span>  <span class="c1"># Type of distribution</span>
    <span class="n">gsigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>  <span class="c1"># Geometric standard deviation</span>
    <span class="n">mode</span><span class="o">=</span><span class="n">modes</span><span class="p">,</span>  <span class="c1"># Modes of the distribution</span>
    <span class="n">nparticles</span><span class="o">=</span><span class="n">number_total</span>  <span class="c1"># Total number of particles</span>
<span class="p">)</span><span class="o">.</span><span class="n">m</span>

<span class="c1"># Convert the distribution from pdf to probability mass function (pmf)</span>
<span class="n">number_conc_pms</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">distribution_convert_pdf_pms</span><span class="p">(</span>
    <span class="n">x_array</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>  <span class="c1"># Array of diameters</span>
    <span class="n">distribution</span><span class="o">=</span><span class="n">pdf_dist</span><span class="p">,</span>  <span class="c1"># The generated pdf</span>
    <span class="n">to_pdf</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># Specifies the conversion to pmf</span>
<span class="p">)</span> <span class="o">*</span> <span class="n">number_total</span>  <span class="c1"># Scale to the total number of particles</span>


<span class="c1"># Convert particle diameters from the base distribution to volumes</span>
<span class="n">volume_sizer</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">length_to_volume</span><span class="p">(</span><span class="n">diameters</span><span class="p">,</span> <span class="n">length_type</span><span class="o">=</span><span class="s1">&#39;diameter&#39;</span><span class="p">)</span>

<span class="c1"># Calculate water volume absorbed by particles at different RH</span>
<span class="n">volume_water_low</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">kappa_volume_water</span><span class="p">(</span>
    <span class="n">volume_solute</span><span class="o">=</span><span class="n">volume_sizer</span><span class="p">,</span>
    <span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span>
    <span class="n">water_activity</span><span class="o">=</span><span class="n">water_activity_low</span><span class="p">)</span>  <span class="c1"># showing the input parameters</span>
<span class="n">volume_water_mid</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">kappa_volume_water</span><span class="p">(</span>
    <span class="n">volume_sizer</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">water_activity_mid</span><span class="p">)</span>
<span class="n">volume_water_high</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">kappa_volume_water</span><span class="p">(</span>
    <span class="n">volume_sizer</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">water_activity_high</span><span class="p">)</span>

<span class="c1"># Calculate new particle diameters after hygroscopic growth</span>
<span class="n">diameters_low</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">volume_to_length</span><span class="p">(</span>
    <span class="n">volume</span><span class="o">=</span><span class="n">volume_sizer</span> <span class="o">+</span> <span class="n">volume_water_low</span><span class="p">,</span>
    <span class="n">length_type</span><span class="o">=</span><span class="s1">&#39;diameter&#39;</span><span class="p">)</span>  <span class="c1"># showing the input parameters</span>
<span class="n">diameters_mid</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">volume_to_length</span><span class="p">(</span>
    <span class="n">volume_sizer</span> <span class="o">+</span> <span class="n">volume_water_mid</span><span class="p">,</span> <span class="s1">&#39;diameter&#39;</span><span class="p">)</span>
<span class="n">diameters_high</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">volume_to_length</span><span class="p">(</span>
    <span class="n">volume_sizer</span> <span class="o">+</span> <span class="n">volume_water_high</span><span class="p">,</span> <span class="s1">&#39;diameter&#39;</span><span class="p">)</span>

<span class="c1"># Plotting the base and grown size distributions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diameters</span><span class="p">,</span> <span class="n">number_conc_pms</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Base Distribution&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">diameters_low</span><span class="p">,</span>
    <span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Low Water Activity: </span><span class="si">{</span><span class="n">water_activity_low</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">diameters_mid</span><span class="p">,</span>
    <span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mid Water Activity: </span><span class="si">{</span><span class="n">water_activity_mid</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">diameters_high</span><span class="p">,</span>
    <span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;High Water Activity: </span><span class="si">{</span><span class="n">water_activity_high</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Diameter (nm)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Number concentration (#/cm^3)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4e5fdfa2b903bdafd67899f0466c789d297877dcb6c17d24b0ce691f0ca4bfbf.png" src="../../_images/4e5fdfa2b903bdafd67899f0466c789d297877dcb6c17d24b0ce691f0ca4bfbf.png" />
</div>
</div>
</section>
</section>
</section>
<section id="simulating-light-extinction-for-hygroscopic-growth">
<h2>Simulating Light Extinction for Hygroscopic Growth<a class="headerlink" href="#simulating-light-extinction-for-hygroscopic-growth" title="Link to this heading">#</a></h2>
<p>After generating synthetic aerosol distributions and analyzing their hygroscopic growth, the next crucial step is to simulate how these changes affect the aerosols’ light extinction properties at different humidity levels. Light extinction, a key optical property, combines the effects of both scattering and absorption by particles, and varies significantly with particle size, composition, and ambient humidity. In this section, we calculate the extinction coefficients for our simulated aerosol distributions at low, mid, and high relative humidity (RH) conditions.</p>
<p>To simulate the extinction at each specified humidity, we employ the <code class="docutils literal notranslate"><span class="pre">extinction_ratio_wet_dry</span></code> function from the <code class="docutils literal notranslate"><span class="pre">kappa_via_extinction</span></code> module. This function calculates the extinction coefficients by considering the hygroscopic growth of particles and their resulting optical properties.</p>
<p><em>Note</em>: The size distribution hygroscopic growth and refractive index mixing are handled internally by the <code class="docutils literal notranslate"><span class="pre">extinction_ratio_wet_dry</span></code> function, so we only need to provide the base size distribution and the RH levels of interest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the kappa value and refractive index for dry particles</span>
<span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.61</span>  <span class="c1"># Kappa value for ammonium sulfate</span>
<span class="n">refractive_index_dry</span> <span class="o">=</span> <span class="mf">1.45</span>  <span class="c1"># Refractive index of dry particles</span>

<span class="c1"># Define the wavelength of light for extinction calculations</span>
<span class="n">wavelength</span> <span class="o">=</span> <span class="mi">450</span>  <span class="c1"># Wavelength in nanometers</span>

<span class="c1"># Calculate extinction coefficients at different humidities</span>
<span class="n">ext_low</span><span class="p">,</span> <span class="n">ext_base</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">extinction_ratio_wet_dry</span><span class="p">(</span>
    <span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Base condition for sizer water activity</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>    <span class="c1"># Dry condition water activity</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_low</span><span class="p">,</span>  <span class="c1"># Low RH condition</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="n">refractive_index_dry</span><span class="p">,</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">discretize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_coefficients</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_optics</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">ext_mid</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">extinction_ratio_wet_dry</span><span class="p">(</span>
    <span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_mid</span><span class="p">,</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="n">refractive_index_dry</span><span class="p">,</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">discretize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_coefficients</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_optics</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ext_high</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">extinction_ratio_wet_dry</span><span class="p">(</span>
    <span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_high</span><span class="p">,</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="n">refractive_index_dry</span><span class="p">,</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">discretize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_coefficients</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_optics</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># print all extinctions</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extinction at 0.0% RH: </span><span class="si">{</span><span class="n">ext_base</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extinction at </span><span class="si">{</span><span class="n">water_activity_low</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH: </span><span class="si">{</span><span class="n">ext_low</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extinction at </span><span class="si">{</span><span class="n">water_activity_mid</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH: </span><span class="si">{</span><span class="n">ext_mid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extinction at </span><span class="si">{</span><span class="n">water_activity_high</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH: </span><span class="si">{</span><span class="n">ext_high</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Extinction at 0.0% RH: 389.78121694944446
Extinction at 30.0% RH: 455.30968285413974
Extinction at 60.0% RH: 606.9502182185443
Extinction at 90.0% RH: 1242.6228046612712
</pre></div>
</div>
</div>
</div>
</section>
<section id="fitting-kappa-hgf-to-dry-aerosol-data">
<h2>Fitting Kappa-HGF to Dry Aerosol Data<a class="headerlink" href="#fitting-kappa-hgf-to-dry-aerosol-data" title="Link to this heading">#</a></h2>
<p>After generating synthetic aerosol distributions and simulating their light extinction at various humidity levels, we proceed to fit the kappa-Hygroscopic Growth Factor (kappa-HGF) to our synthetic data. This process involves using the extinction data previously calculated to infer the kappa-HGF values that best describe the observed changes in light extinction due to hygroscopic growth.</p>
<p>To achieve this, we employ the <code class="docutils literal notranslate"><span class="pre">fit_extinction_ratio_with_kappa</span></code> function from the <code class="docutils literal notranslate"><span class="pre">kappa_via_extinction</span></code> module. This function optimizes the kappa value to match the simulated wet-to-dry extinction ratio, providing a quantitative measure of the particles’ hygroscopicity. The fitting is performed for low, mid, and high humidity conditions, allowing us to observe how kappa-HGF varies with relative humidity (RH) of the measurement environment. It should be relatively close to the kappa value used in the synthetic data generation (0.61).</p>
<p>This code snippet demonstrates the process of fitting kappa-HGF to the synthetic data, highlighting the kappa values obtained for different RH conditions. The fitting process is crucial for translating the wet-to-dry extinction ratios into a meaningful measure of particle hygroscopicity, which can then be used to improve our understanding of aerosol behavior in the atmosphere.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_low</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">fit_extinction_ratio_with_kappa</span><span class="p">(</span>
    <span class="n">b_ext_dry</span><span class="o">=</span><span class="n">ext_base</span><span class="p">,</span>
    <span class="n">b_ext_wet</span><span class="o">=</span><span class="n">ext_low</span><span class="p">,</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_low</span><span class="p">,</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="n">refractive_index_dry</span><span class="p">,</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">discretize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kappa_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">kappa_tolerance</span><span class="o">=</span> <span class="mf">1e-12</span><span class="p">,</span>
    <span class="n">kappa_maxiter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fit_mid</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">fit_extinction_ratio_with_kappa</span><span class="p">(</span>
    <span class="n">b_ext_dry</span><span class="o">=</span><span class="n">ext_base</span><span class="p">,</span>
    <span class="n">b_ext_wet</span><span class="o">=</span><span class="n">ext_mid</span><span class="p">,</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_mid</span><span class="p">,</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="n">refractive_index_dry</span><span class="p">,</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">discretize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kappa_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">kappa_tolerance</span><span class="o">=</span> <span class="mf">1e-12</span><span class="p">,</span>
    <span class="n">kappa_maxiter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fit_high</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">fit_extinction_ratio_with_kappa</span><span class="p">(</span>
    <span class="n">b_ext_dry</span><span class="o">=</span><span class="n">ext_base</span><span class="p">,</span>
    <span class="n">b_ext_wet</span><span class="o">=</span><span class="n">ext_high</span><span class="p">,</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_high</span><span class="p">,</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="n">refractive_index_dry</span><span class="p">,</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">discretize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kappa_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">kappa_tolerance</span><span class="o">=</span> <span class="mf">1e-12</span><span class="p">,</span>
    <span class="n">kappa_maxiter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># print all fits</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kappa at </span><span class="si">{</span><span class="n">water_activity_low</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH: </span><span class="si">{</span><span class="n">fit_low</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kappa at </span><span class="si">{</span><span class="n">water_activity_mid</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH: </span><span class="si">{</span><span class="n">fit_mid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kappa at </span><span class="si">{</span><span class="n">water_activity_high</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH: </span><span class="si">{</span><span class="n">fit_high</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kappa at 30.0% RH: 0.6052222023205293
Kappa at 60.0% RH: 0.6100000039432478
Kappa at 90.0% RH: 0.6100627049381072
</pre></div>
</div>
</div>
</div>
</section>
<section id="insensitivity-to-humidity-in-sizer-and-extinction-measurements">
<h2>Insensitivity to Humidity in Sizer and Extinction Measurements<a class="headerlink" href="#insensitivity-to-humidity-in-sizer-and-extinction-measurements" title="Link to this heading">#</a></h2>
<p>In the complex world of atmospheric measurements, not all data are perfect. One of the challenges is dealing with the humidity effects on both the size distribution measurements and the extinction coefficients for dry and wet aerosol particles. This section demonstrates that by carefully accounting for humidity in these measurements, the fitted kappa-Hygroscopic Growth Factor (kappa-HGF) remains robust and insensitive to variations in the size distribution caused by humidity. This resilience is particularly crucial when dealing with ambient measurements, where the assumption of perfectly dry particles may not hold.</p>
<section id="fitting-kappa-hgf-under-varied-humidity-conditions">
<h3>Fitting Kappa-HGF under Varied Humidity Conditions<a class="headerlink" href="#fitting-kappa-hgf-under-varied-humidity-conditions" title="Link to this heading">#</a></h3>
<p>To illustrate this point, we perform kappa-HGF fitting under conditions where the sizer humidity is not zero, simulating more realistic scenarios where dry particles may still retain some moisture. We explore how kappa-HGF responds to changes in the humidity of the sizer used to measure the size distribution and the humidity conditions under which dry and wet extinction coefficients are obtained.</p>
</section>
<section id="key-insights">
<h3>Key Insights<a class="headerlink" href="#key-insights" title="Link to this heading">#</a></h3>
<p>The kappa-HGF fitting outcomes demonstrate that the approach remains effective even when the sizer’s humidity and the conditions for measuring dry and wet extinctions incorporate realistic humidity levels. This robustness ensures that kappa-HGF can be accurately determined from ambient aerosol measurements, accommodating the inherent moisture that may be present in “dry” aerosol samples.</p>
<p>Understanding and adjusting for these nuances in humidity is essential for accurately characterizing aerosol optical properties and their environmental impacts. By acknowledging and accounting for these factors in our analysis, we enhance the reliability of kappa-HGF estimations, paving the way for more accurate atmospheric models and predictions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Perform kappa-HGF fitting with a humid sizer at mid RH</span>
<span class="n">fit_humid_sizer_mid</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">fit_extinction_ratio_with_kappa</span><span class="p">(</span>
    <span class="n">b_ext_dry</span><span class="o">=</span><span class="n">ext_base</span><span class="p">,</span>
    <span class="n">b_ext_wet</span><span class="o">=</span><span class="n">ext_mid</span><span class="p">,</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters_mid</span><span class="p">,</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="n">water_activity_mid</span><span class="p">,</span>  <span class="c1"># Sizer humidity set to mid RH</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Dry condition</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_mid</span><span class="p">,</span>  <span class="c1"># Wet condition matches sizer RH</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="n">refractive_index_dry</span><span class="p">,</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">discretize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kappa_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">kappa_tolerance</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span>
    <span class="n">kappa_maxiter</span><span class="o">=</span><span class="mi">200</span>
<span class="p">)</span>

<span class="c1"># Repeat fitting with humid sizer at mid RH and extinction measurements at</span>
<span class="c1"># low and high RH</span>
<span class="n">fit_humid_sizer_mid_and_humid_ext_low</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">fit_extinction_ratio_with_kappa</span><span class="p">(</span>
    <span class="n">b_ext_dry</span><span class="o">=</span><span class="n">ext_low</span><span class="p">,</span>  <span class="c1"># Dry extinction at low RH</span>
    <span class="n">b_ext_wet</span><span class="o">=</span><span class="n">ext_high</span><span class="p">,</span>  <span class="c1"># Wet extinction at high RH</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters_mid</span><span class="p">,</span>  <span class="c1"># Diameters adjusted for mid RH</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="n">water_activity_mid</span><span class="p">,</span>  <span class="c1"># Mid RH for sizer</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="n">water_activity_low</span><span class="p">,</span>  <span class="c1"># Low RH for dry condition</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_high</span><span class="p">,</span>  <span class="c1"># High RH for wet condition</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="n">refractive_index_dry</span><span class="p">,</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">discretize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kappa_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">kappa_tolerance</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span>
    <span class="n">kappa_maxiter</span><span class="o">=</span><span class="mi">200</span>
<span class="p">)</span>

<span class="c1"># Print the fitted kappa values</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Kappa from humid sizer at </span><span class="si">{</span><span class="n">water_activity_mid</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH and dry Ext: </span><span class="si">{</span><span class="n">fit_humid_sizer_mid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kappa from humid sizer at </span><span class="si">{</span><span class="n">water_activity_mid</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH and humid Ext from </span><span class="si">{</span><span class="n">water_activity_low</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH to </span><span class="si">{</span><span class="n">water_activity_high</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH: </span><span class="si">{</span><span class="n">fit_humid_sizer_mid_and_humid_ext_low</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kappa from humid sizer at 60.0% RH and dry Ext: 0.6100000005341281
Kappa from humid sizer at 60.0% RH and humid Ext from 30.0% RH to 90.0% RH: 0.6099999998804534
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="examining-the-impact-of-dry-refractive-index-on-kappa-hgf-estimation">
<h2>Examining the Impact of Dry Refractive Index on Kappa-HGF Estimation<a class="headerlink" href="#examining-the-impact-of-dry-refractive-index-on-kappa-hgf-estimation" title="Link to this heading">#</a></h2>
<p>The refractive index of aerosol particles plays a pivotal role in determining their optical properties, such as light extinction. When deducing the kappa-Hygroscopic Growth Factor (kappa-HGF) from light extinction data, the choice of the dry aerosol particle’s refractive index can significantly influence the precision of the resulting kappa estimation. This exploration delves into the sensitivity of the kappa-HGF fitting process to variations in the assumed dry refractive index, underscoring the necessity of accurately selecting this parameter for reliable hygroscopicity assessments.</p>
<p>Initially, we assumed a dry refractive index of (1.45 + 0i) for generating extinction data. Here, we venture into how alterations in this assumed refractive index affect the kappa-HGF fitting outcomes. Specifically, we examine the response of the kappa-HGF fitting to both modest deviations and more pronounced shifts from the initially assumed value, including both lower and higher indices, to ascertain the robustness of kappa estimation against such variations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fitting kappa-HGF with varied assumptions on the dry refractive index</span>
<span class="n">fit_refractive_index_lower</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">fit_extinction_ratio_with_kappa</span><span class="p">(</span>
    <span class="n">b_ext_dry</span><span class="o">=</span><span class="n">ext_base</span><span class="p">,</span>
    <span class="n">b_ext_wet</span><span class="o">=</span><span class="n">ext_mid</span><span class="p">,</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_mid</span><span class="p">,</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="mf">1.4</span><span class="p">,</span>  <span class="c1"># Assumption of a lower refractive index</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">kappa_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">kappa_tolerance</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span>
    <span class="n">kappa_maxiter</span><span class="o">=</span><span class="mi">200</span>
<span class="p">)</span>

<span class="n">fit_refractive_index_higher</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">fit_extinction_ratio_with_kappa</span><span class="p">(</span>
    <span class="n">b_ext_dry</span><span class="o">=</span><span class="n">ext_base</span><span class="p">,</span>
    <span class="n">b_ext_wet</span><span class="o">=</span><span class="n">ext_mid</span><span class="p">,</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_mid</span><span class="p">,</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="mf">1.55</span><span class="p">,</span>  <span class="c1"># Assumption of a higher refractive index</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">kappa_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">kappa_tolerance</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span>
    <span class="n">kappa_maxiter</span><span class="o">=</span><span class="mi">200</span>
<span class="p">)</span>

<span class="n">fit_refractive_index_close</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">fit_extinction_ratio_with_kappa</span><span class="p">(</span>
    <span class="n">b_ext_dry</span><span class="o">=</span><span class="n">ext_base</span><span class="p">,</span>
    <span class="n">b_ext_wet</span><span class="o">=</span><span class="n">ext_mid</span><span class="p">,</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="p">,</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_mid</span><span class="p">,</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="mf">1.48</span><span class="p">,</span>  <span class="c1"># A close but distinct refractive index</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">kappa_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">kappa_tolerance</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span>
    <span class="n">kappa_maxiter</span><span class="o">=</span><span class="mi">200</span>
<span class="p">)</span>

<span class="c1"># Output the fitted kappa values for each refractive index assumption</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kappa from lower refractive index 1.4: </span><span class="si">{</span><span class="n">fit_refractive_index_lower</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Kappa from higher refractive index 1.55: </span><span class="si">{</span><span class="n">fit_refractive_index_higher</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kappa from close refractive index 1.48: </span><span class="si">{</span><span class="n">fit_refractive_index_close</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kappa from lower refractive index 1.4: 0.5112947684591398
Kappa from higher refractive index 1.55: 0.7043352860513862
Kappa from close refractive index 1.48: 0.6563062276765873
</pre></div>
</div>
</div>
</div>
</section>
<section id="robustness-of-kappa-hgf-estimation-against-particle-number-variations">
<h2>Robustness of Kappa-HGF Estimation Against Particle Number Variations<a class="headerlink" href="#robustness-of-kappa-hgf-estimation-against-particle-number-variations" title="Link to this heading">#</a></h2>
<p>A noteworthy aspect of estimating the kappa-Hygroscopic Growth Factor (kappa-HGF) from light extinction measurements is its robustness to variations in the total number of aerosol particles. This resilience is attributed to the optimization process focusing on the extinction ratio rather than absolute extinction values. Consequently, discrepancies in the total particle number do not significantly affect the kappa-HGF fitting outcomes. This section demonstrates this principle by applying kappa-HGF fitting to synthetic datasets with deliberately altered particle number concentrations.</p>
<section id="demonstrating-insensitivity-through-particle-number-variation">
<h3>Demonstrating Insensitivity through Particle Number Variation<a class="headerlink" href="#demonstrating-insensitivity-through-particle-number-variation" title="Link to this heading">#</a></h3>
<p>The experiment involves adjusting the particle number concentration to 20% of its original value in the synthetic dataset. Despite this substantial reduction, we observe that the kappa-HGF estimation process yields consistent results, underscoring the fitting technique’s insensitivity to the absolute particle count within the aerosol distribution. This characteristic is particularly advantageous when dealing with ambient measurements, where precise particle counting may be challenging.</p>
</section>
<section id="implications-for-ambient-aerosol-measurements">
<h3>Implications for Ambient Aerosol Measurements<a class="headerlink" href="#implications-for-ambient-aerosol-measurements" title="Link to this heading">#</a></h3>
<p>The findings from this sensitivity analysis have implications for conducting ambient aerosol measurements and analyses. They highlight the fitting process’s adaptability and accuracy, even when the exact particle count is uncertain or varies across measurements. As long as the relative distribution of particle sizes remains representative of the aerosol population under study, kappa-HGF estimates can be reliably derived, facilitating accurate assessments of aerosol hygroscopicity and its atmospheric impacts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_low_number</span> <span class="o">=</span> <span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">fit_extinction_ratio_with_kappa</span><span class="p">(</span>
    <span class="n">b_ext_dry</span><span class="o">=</span><span class="n">ext_base</span><span class="p">,</span>
    <span class="n">b_ext_wet</span><span class="o">=</span><span class="n">ext_high</span><span class="p">,</span>
    <span class="n">number_per_cm3</span><span class="o">=</span><span class="n">number_conc_pms</span><span class="o">*</span><span class="mf">0.2</span><span class="p">,</span>  <span class="c1"># 20% of the base number concentration</span>
    <span class="n">diameters</span><span class="o">=</span><span class="n">diameters</span><span class="p">,</span>
    <span class="n">water_activity_sizer</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_dry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">water_activity_wet</span><span class="o">=</span><span class="n">water_activity_high</span><span class="p">,</span>
    <span class="n">refractive_index_dry</span><span class="o">=</span><span class="n">refractive_index_dry</span><span class="p">,</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
    <span class="n">discretize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kappa_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">kappa_tolerance</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span>
    <span class="n">kappa_maxiter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># print result</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kappa at </span><span class="si">{</span><span class="n">water_activity_high</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% RH with 20% of the particles: </span><span class="si">{</span><span class="n">fit_low_number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kappa at 90.0% RH with 20% of the particles: 0.6100627049381069
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="summary-of-kappa-hgf-fitting-notebook">
<h2>Summary of Kappa-HGF Fitting Notebook<a class="headerlink" href="#summary-of-kappa-hgf-fitting-notebook" title="Link to this heading">#</a></h2>
<p>This notebook delves into the intricacies of fitting the kappa-Hygroscopic Growth Factor (kappa-HGF) using synthetic aerosol data. The kappa-HGF is an essential parameter in atmospheric sciences, quantifying the water-absorbing capabilities of aerosol particles and their influence on cloud formation and climate. The notebook methodically guides through generating synthetic aerosol size distributions, simulating their light extinction under various humidity conditions, and employing these simulations to estimate kappa-HGF. Key highlights include:</p>
<section id="synthetic-data-generation">
<h3>Synthetic Data Generation<a class="headerlink" href="#synthetic-data-generation" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Aerosol Size Distribution</strong>: We created synthetic bimodal log-normal size distributions, representing atmospheric aerosol populations. This step is crucial for simulating realistic aerosol behaviors under varying environmental conditions.</p></li>
<li><p><strong>Hygroscopic Growth Simulation</strong>: By adjusting the size distribution for different relative humidity levels, we simulated the hygroscopic growth of aerosols, providing a foundation for subsequent extinction calculations.</p></li>
<li><p><strong>Extinction Coefficients</strong>: We calculated light extinction coefficients for the synthetic aerosol distributions at low, mid, and high humidity levels.</p></li>
</ul>
</section>
<section id="kappa-hgf-fitting">
<h3>Kappa-HGF Fitting<a class="headerlink" href="#kappa-hgf-fitting" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Insensitivity to Humidity in Measurements</strong>: Demonstrating the fitting process’s robustness, we showed that kappa-HGF estimation is insensitive to variations in humidity during size distribution measurements, ensuring reliable kappa estimations from ambient aerosol data.</p></li>
<li><p><strong>Sensitivity to Dry Refractive Index</strong>: Exploring the impact of the assumed dry refractive index on kappa-HGF fitting revealed the importance of accurately selecting this parameter for precise hygroscopicity assessments.</p></li>
<li><p><strong>Insensitivity Against Particle Number</strong>: The kappa-HGF fitting process proved to be resilient to changes in the total number of aerosol particles, emphasizing the method’s suitability for ambient aerosol studies where particle counts may fluctuate.</p></li>
</ul>
</section>
<section id="conclusions-and-implications">
<h3>Conclusions and Implications<a class="headerlink" href="#conclusions-and-implications" title="Link to this heading">#</a></h3>
<p>The notebook’s findings underscore the efficacy and reliability of the kappa-HGF fitting process, even under the inherent variability and uncertainties of atmospheric aerosol measurements. By accurately estimating kappa-HGF from light extinction data, scientists can better understand aerosol hygroscopic growth, improving models of aerosol-cloud interactions and assessing aerosols’ environmental and climatic impacts. This work highlights the critical role of precise parameter selection and the robustness of the kappa-HGF estimation process, contributing valuable insights to the field of atmospheric sciences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">extinction_ratio_wet_dry</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function extinction_ratio_wet_dry in module particula.data.process.kappa_via_extinction:

extinction_ratio_wet_dry(kappa: Union[float, numpy.ndarray[Any, numpy.dtype[numpy.float64]]], number_per_cm3: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], diameters: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], water_activity_sizer: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], water_activity_dry: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], water_activity_wet: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], refractive_index_dry: Union[complex, float] = 1.45, water_refractive_index: Union[complex, float] = 1.33, wavelength: float = 450, discretize: bool = True, return_coefficients: bool = False, return_all_optics: bool = False) -&gt; Union[float, Tuple[numpy.ndarray[Any, numpy.dtype[+_ScalarType_co]], numpy.ndarray[Any, numpy.dtype[+_ScalarType_co]]]]
    Calculates the extinction ratio between wet and dry aerosols, considering
    water uptake through kappa. This function uses Mie theory to determine the
    optical properties of aerosols with varying water content, allowing for
    analysis of hygroscopic growth and its impact on aerosol optical
    characteristics.
    
    Parameters
    ----------
    kappa : Union[float, NDArray[np.float64]]
        Hygroscopicity parameter, defining water uptake ability of particles.
    number_per_cm3 : NDArray[np.float64]
        Number concentration of particles per cubic centimeter for each size
        bin.
    diameters : NDArray[np.float64]
        Diameters of particles in nanometers for each size bin.
    water_activity_sizer : NDArray[np.float64]
        Water activity of the aerosol size distribution.
    water_activity_dry : NDArray[np.float64]
        Water activity for the calculation of &#39;dry&#39; aerosol properties.
    water_activity_wet : NDArray[np.float64]
        Water activity for the calculation of &#39;wet&#39; aerosol properties.
    refractive_index_dry : Union[complex, float, np.float16], optional
        Refractive index of the dry aerosol particles.
    water_refractive_index : Union[complex, float], optional
        Refractive index of water.
    wavelength : float, optional
        Wavelength of the incident light in nanometers.
    discretize : bool, optional
        If True, discretizes input parameters for Mie calculations to enable
        caching.
    return_coefficients : bool, optional
        If True, returns the individual extinction coefficients for wet and
        dry aerosols instead of their ratio.
    return_all_optics : bool, optional
        If True, returns all optical properties calculated by Mie theory,
        not just extinction.
    
    Returns
    -------
    Union[float, Tuple[NDArray, NDArray]]
        By default, returns the ratio of wet to dry aerosol extinction.
        If `return_coefficients` is True, returns a tuple of NDArrays
        containing the extinction coefficients for wet and dry aerosols,
        respectively.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">fit_extinction_ratio_with_kappa</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function fit_extinction_ratio_with_kappa in module particula.data.process.kappa_via_extinction:

fit_extinction_ratio_with_kappa(b_ext_dry: Union[float, numpy.float64], b_ext_wet: Union[float, numpy.float64], number_per_cm3: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], diameters: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], water_activity_sizer: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], water_activity_dry: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], water_activity_wet: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], refractive_index_dry: Union[complex, float] = 1.45, water_refractive_index: Union[complex, float] = 1.33, wavelength: float = 450, discretize: bool = True, kappa_bounds: Tuple[float, float] = (0, 1), kappa_tolerance: float = 1e-06, kappa_maxiter: int = 200) -&gt; Union[float, numpy.float64]
    Fits the kappa parameter based on the measured extinction ratios of dry
    and wet aerosols, utilizing Mie theory to account for water uptake
    effects. This method optimizes kappa to minimize the difference between
    the calculated and observed extinction ratio of wet to dry aerosols.
    
    Parameters
    ----------
    b_ext_dry : Union[float, np.float64]
        The measured extinction of the dry aerosol.
    b_ext_wet : Union[float, np.float64]
        The measured extinction of the wet aerosol.
    number_per_cm3 : NDArray[np.float64]
        The number concentration of particles per cubic centimeter for each
        size bin.
    diameters : NDArray[np.float64]
        The diameters of particles in nanometers for each size bin.
    water_activity_sizer : NDArray[np.float64]
        The water activity corresponding to the aerosol size distribution.
    water_activity_dry : NDArray[np.float64]
        The water activity for the &#39;dry&#39; aerosol condition.
    water_activity_wet : NDArray[np.float64]
        The water activity for the &#39;wet&#39; aerosol condition.
    refractive_index_dry : Union[complex, float, np.float16], optional
        The refractive index of the dry aerosol particles.
    water_refractive_index : Union[complex, float], optional
        The refractive index of water.
    wavelength : float, optional
        The wavelength of incident light in nanometers.
    discretize : bool, optional
        If True, discretizes input parameters for Mie calculations to enable
        caching.
    kappa_bounds : Tuple[float, float], optional
        The bounds within which to fit the kappa parameter.
    kappa_tolerance : float, optional
        The tolerance level for the optimization of kappa.
    kappa_maxiter : int, optional
        The maximum number of iterations allowed in the optimization process.
    
    Returns
    -------
    Union[float, np.float64]
        The optimized kappa parameter that best fits the observed extinction
        ratios.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">kappa_via_extinction</span><span class="o">.</span><span class="n">kappa_from_extinction_looped</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function kappa_from_extinction_looped in module particula.data.process.kappa_via_extinction:

kappa_from_extinction_looped(extinction_dry: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], extinction_wet: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], number_per_cm3: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], diameter: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], water_activity_sizer: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], water_activity_sample_dry: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], water_activity_sample_wet: numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]], refractive_index_dry: Union[complex, float] = 1.45, water_refractive_index: Union[complex, float] = 1.33, wavelength: float = 450, discretize: bool = True) -&gt; numpy.ndarray[typing.Any, numpy.dtype[numpy.float64]]
    Fits the extinction ratio to the kappa value for a given set of
    measurements, looping over time indexes in number_per_cm3. This function
    is tailored for analyzing data from a CAPS (Cavity Attenuated Phase Shift)
    instrument under varying humidities.
    
    Parameters
    ----------
    extinction_dry : NDArray[np.float64]
        Array of dry aerosol extinction measurements.
    extinction_wet : NDArray[np.float64]
        Array of wet aerosol extinction measurements.
    number_per_cm3 : NDArray[np.float64]
        Array of particle number concentrations in #/cm³.
    diameter : NDArray[np.float64]
        Array of particle diameters.
    water_activity_sizer : NDArray[np.float64]
        Water activity (relative humidity/100) of the sizing instrument&#39;s air.
    water_activity_sample_dry : NDArray[np.float64]
        Water activity (relative humidity/100) of the air for dry measurements.
    water_activity_sample_wet : NDArray[np.float64]
        Water activity (relative humidity/100) of the air for wet measurements.
    refractive_index_dry : Union[complex, float], optional
        Refractive index of dry particles. Default is 1.45.
    water_refractive_index : Union[complex, float], optional
        Refractive index of water. Default is 1.33.
    wavelength : float, optional
        Wavelength of the light source in nanometers. Default is 450.
    discretize : bool, optional
        If True, calculations are performed with discretized parameter values
        to potentially improve performance. Default is True.
    
    Returns
    -------
    NDArray[np.float64]
        A 2D array where each row corresponds to the time-indexed kappa value,
        lower and upper bounds of the kappa estimation, structured as
        [kappa, lower, upper].
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "uncscode/particula",
            ref: "v0.0.10",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./examples/light_scattering"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="humid_scattering.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Scattering for Humidified Particles</p>
      </div>
    </a>
    <a class="right-next"
       href="scattering_truncation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Scattering Truncation Corrections</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-synthetic-data-for-kappa-hgf-analysis">Generating Synthetic Data for Kappa-HGF Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hygroscopic-growth-parameters">Hygroscopic Growth Parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#size-distribution">Size Distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-steps">Calculation Steps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-light-extinction-for-hygroscopic-growth">Simulating Light Extinction for Hygroscopic Growth</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-kappa-hgf-to-dry-aerosol-data">Fitting Kappa-HGF to Dry Aerosol Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#insensitivity-to-humidity-in-sizer-and-extinction-measurements">Insensitivity to Humidity in Sizer and Extinction Measurements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-kappa-hgf-under-varied-humidity-conditions">Fitting Kappa-HGF under Varied Humidity Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-insights">Key Insights</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examining-the-impact-of-dry-refractive-index-on-kappa-hgf-estimation">Examining the Impact of Dry Refractive Index on Kappa-HGF Estimation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robustness-of-kappa-hgf-estimation-against-particle-number-variations">Robustness of Kappa-HGF Estimation Against Particle Number Variations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstrating-insensitivity-through-particle-number-variation">Demonstrating Insensitivity through Particle Number Variation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implications-for-ambient-aerosol-measurements">Implications for Ambient Aerosol Measurements</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-kappa-hgf-fitting-notebook">Summary of Kappa-HGF Fitting Notebook</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#synthetic-data-generation">Synthetic Data Generation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kappa-hgf-fitting">Kappa-HGF Fitting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions-and-implications">Conclusions and Implications</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By particula contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>